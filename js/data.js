/* js/data.js */
const familyData = {
    'yu': {
        name: "虞家", title: "统治者", color: "text-yu-gold",
        desc: "类比古代皇室，国家的绝对主宰。控制着虞元的发行、全球能源网络及所有公民数据，家主掌控一切，旁系多持干股分红，安于享乐。",
        monopoly: "军工、货币金融、能源科技、通讯交通、航空航天、核电工业、基本民生保障产业", roles: ["家主","侍官长 (NPC)","家主亲弟","表亲少爷","旁系子弟","家主私奴"]
    },
    'xi': {
        name: "奚家", title: "罪奴", color: "text-red-700",
        desc: "世代功勋，文臣之首，主导了虞宫的律法修订与教育体系建立，遵循“慎独笃行，博众而新”的责训，其子弟多从政。不久前因丞辅“谋逆”，除少主外，全族连坐打为罪奴籍。",
        monopoly: "已剥夺 (曾垄断律法修订与教育体制改革)", roles: ["家主 (NPC)","少主","旁系子弟","管家"]
    },
    'duwei': {
        name: "都尉家", title: "权贵 - 军门", color: "text-yu-purple",
        desc: "以武立身，世代掌军，虞家最信赖的“刀柄”。家族成员近乎全员皆兵，垄断军工与重工业，极少参与文官内斗，家主通常担任【督军】。",
        monopoly: "重工业、跨地域物流及在军工产业中持股并参与决策", roles: ["家主 (NPC)","旁系子弟","管家"]
    },
    'que': {
        name: "闻家", title: "权贵 - 地产", color: "text-yu-purple",
        desc: "权贵中最大的实务派，秉持“政商一体，经济至上”，把控虞宫近半资金流转。闻家精于计算，讲求效率，从不做无谓的投入。",
        monopoly: "建筑与房产开发、风投与国际贸易", roles: ["家主", "少主", "直系子弟", "旁系子弟","管家"]
    },
    'bo': {
        name: "褚家", title: "权贵 - 科研", color: "text-yu-purple",
        desc: "严谨老派的世家贵族，行事低调、保守，不轻易参与激进的政治斗争，是真正具有深厚底蕴的权贵世家。家族治学严谨，沉迷学术科研，藏锋于无形。",
        monopoly: "生物医疗与学术研究，奚家倒台后，教育行业被其掌控大半", roles: ["家主", "少主", "直系子弟", "旁系子弟","管家"]
    },
    'thin': {
        name: "薄家", title: "贵族 - 法律", color: "text-white",
        desc: "虽无立法权，但垄断了法律解释与执行服务，现任家主曾是奚仲门生，因“检举有功”保全家族。",
        monopoly: "法律咨询与诉讼代理、家族信托与保险", roles: ["家主","直系子弟", "旁系子弟","执事"]
    },
    'duan': {
        name: "段家", title: "贵族 - 专利", color: "text-white",
        desc: "推崇技术商业化，家族成员致力于打通“技术-资金”闭环，多往财政方向发展。",
        monopoly: "专利代理、医美科技", roles: ["家主","直系子弟", "旁系子弟","执事"]
    },
    'si': {
        name: "司家", title: "贵族 - 文娱", color: "text-white",
        desc: "家族不过多干涉家族成员在外庭的就职选择，子弟虽多任无实权的行政辅理职，但消息最为灵通，擅长知微见著。",
        monopoly: "文化娱乐产业及高级家政培训（执事/管家/高级侍奴）", roles: ["家主","直系子弟", "旁系子弟","执事"]
    },
    'ming': {
        name: "明家", title: "贵族 - 艺术", color: "text-white",
        desc: "家族成员气质高雅，家主为原虞家主母的青梅竹马。奚家倒台后接手部分教育行业，试图在褚家的学术体系外开辟“艺术教育”赛道。",
        monopoly: "艺术与精英素质教育", roles: ["家主","直系子弟", "旁系子弟","执事"]
    }
};

/* js/data.js - 户籍系统资料核对版 */

const citizenData = {
    'citizen': {
        title: "公民籍", 
        chip: "绿色身份芯片", 
        color: "text-green-500",
        desc: "国家的基石，拥有完整的法律人格与财产权利。",
        origin: "在【虞宫治辖领土】内合法出生，且父母均为公民籍；或经虞家家主特赦的、有重大功绩的个体。",
        rights: [
            "**财产权**：可拥有和继承私有财产。",
            "**择业权**：可自由选择职业（不含被世家垄断的行业）。",
            "**迁徙权**：可在【外城区】和【中城区】内自由迁徙。",
            "**婚配权**：可与公民籍自由通婚。"
        ],
        benefits: [
            "享有【理事厅】下发的社会基础保障。",
            "可进入所有公共消费、娱乐、医疗场所。",
            "法律上，生命权受《虞宫律》保护。"
        ],
        flow: "可能因获罪、巨额负债或家族被清算而降为【奴籍】或【罪奴籍】。"
    },
    'slave': {
        title: "奴籍", 
        chip: "蓝色身份芯片", 
        color: "text-blue-500",
        desc: "从属资产，无独立法律人格，依附于主人或机构。",
        origin: "任何纳入【训御司】管理范畴的个体；奴籍后代；或因犯罪、负债而降级为奴的公民。",
        rights: [
            "**无财产权**：名义上的一切“财产”均为主人所有。",
            "**无择业权**：从事何种劳作完全由主人或训御司决定。",
            "**有限迁徙权**：行动范围由主人设定，离开指定区域会触发警报。",
            "**婚配权**：可在主人批准后，与奴籍自由婚配、生育。"
        ],
        benefits: [
            "享有由主人或训御司提供的基础工资。",
            "可进入所有公共消费、娱乐、医疗场所。",
            "法律上，生命权归其主人所有。主人处死自己的奴隶，仅需向训御司报备“损耗”。"
        ],
        flow: "唯一途径是经虞家家主亲自恩准，恢复【公民籍】；可因触犯重罪被降为【罪奴籍】。"
    },
    'sinner': {
        title: "罪奴籍", 
        chip: "红色身份芯片（伴有警报）", 
        color: "text-red-600",
        desc: "戴罪之身，被剥夺一切权利，仅作为消耗品存在。",
        origin: "犯下谋逆、叛国、重罪者及其直系亲属（连坐）；屡次触犯铁律者；得罪亲贵或权贵者。",
        rights: [
            "**无任何权利**：不被视为“人”，其存在仅为劳作和赎罪。",
            "**无择业权**：只能从事最低贱的差事，任何公民/奴籍均享有使用权。",
            "**无迁徙权**：佩戴电子监察项圈，受【训御司】24小时监察。若有外出，须提前三日报备。",
            "**无婚配权**：无婚配权，必要时可配种。"
        ],
        benefits: [
            "其主人或训御司不必提供基础工资。训御司仅提供每月基础物资给养。",
            "持有者可依据喜好仅提供每月基础物资给养或高待遇饲养（需缴纳高额税金）。",
            "不受《虞宫律》生命保护。任何主位杀死罪奴，均无需承担责任。"
        ],
        flow: "理论上不可能向上流动。"
    }
};

/**
 * 虞宫官职详情数据库
 */
const rankDatabase = {
    // --- 外庭文职 ---
    "丞辅": {
        dept: "理事厅 / 议阁",
        count: "一位",
        info: "文臣之首，辅佐家主处理外庭重要事务。议阁总负责人，家主危重且无指派时，与督军共同代理君职。"
    },
    "公卿": {
        dept: "议阁",
        count: "十二位",
        info: "议阁成员，由贵族阶级构成。负责与君主或实务派交流沟通贵族需求的代表人。"
    },
    "执理事": {
        dept: "理事厅",
        count: "两位",
        info: "理事厅负责人，处理各机要事务的常务。主要就实务与公卿进行探讨交流。"
    },
    "少理事": {
        dept: "理事厅",
        count: "四位（每位执理事配两名）",
        info: "理事厅次职，辅助执理事处理各司事务及主持会议。"
    },
    "司长": {
        dept: "理事厅下属各司",
        count: "六位 (每司一位)",
        info: "中央司部主责任人，各司总理，负责将事务细分至各庭执行，重要事务上报理事厅。"
    },
    "庭执官": {
        dept: "各司下属各庭",
        count: "十二位 (每司两名 / 每庭一名)",
        info: "隶属于各司的事务分配与执行，负责中央命令与各地事务汇总梳理的上传下达。因各司责任不同，具体职工有所区分。"
    },
    "属员": {
        dept: "各庭下属部",
        count: "不计数",
        info: "外庭最低执行级，负责各司事务分派的实际执行。多由士绅经考试选拔而来。"
    },
    "外属": {
        dept: "地方 (省级)",
        count: "按区块划分",
        info: "中央外派的行政责任人，负责省级行政层级的统筹管理。"
    },
    "地方官员": {
        dept: "地方 (市级及以下)",
        count: "按行政区划分",
        info: "分派在各地的文职负责人，管理市级行政管理等级事务。依据需要设下属内宅的执事与行政管理的卫官，等级从七品往下类推，不再设次品级，最低为九品。"
    },

    // --- 外庭武职 ---
    "督军": {
        dept: "军仲厅",
        count: "一位",
        info: "武官之首，最高军事指挥机构领导者。负责管理除属军外的所有常规武装力量。"
    },
    "律官": {
        dept: "军仲厅",
        count: "两位",
        info: "督军辅理，负责辅助管理司、庭武职事务。"
    },
    "少律长": {
        dept: "军仲厅",
        count: "两位",
        info: "律官副手，辅助处理军职事务及辅助管理分管司事务。"
    },
    "廷御": {
        dept: "家主直辖 - 属军",
        count: "一位",
        info: "家主私人精锐属军负责人，仅听从家主或督军的直接命令。"
    },
    "少御使": {
        dept: "家主直辖 - 属军",
        count: "两位",
        info: "廷御的辅理，协助统率家主私人武装。"
    },
    "骑士": {
        dept: "镇巡司 / 督御司",
        count: "两位（每司一位）",
        info: "司级武职，负责具体军事执行与司部武装管理。"
    },
    "巡行官": {
        dept: "驻防/征训/军工/政裁庭",
        count: "四位 (每庭一名)",
        info: "庭级武职，负责巡查及具体武职事务分派执行。"
    },
    "侍卫": {
        dept: "边巡 / 镇狱 / 国防 / 军政等属部",
        count: "不计数",
        info: "各属部的武力执行者，负责具体的国防与巡视任务。"
    },
    "卫军": {
        dept: "家主直辖 - 属军",
        count: "不计数",
        info: "属军军士的统称。"
    },
    "普通卫兵": {
        dept: "外属地军队 (省级)",
        count: "按防区定员",
        info: "驻扎在都城之外各行政属地的常规守备力量，负责维持属地大环境稳定及常规军事巡逻。"
    },
    "地方武装": {
        dept: "地方常规军 (市级及以下)",
        count: "按防区定员",
        info: "最基层的武装力量，负责各城镇的具体治安，等级从七品往下类推，不再设次品级，最低为九品。"
    },

    // --- 内庭侍职 ---
    "家主夫人": {
        dept: "虞宫内庭",
        count: "一位",
        info: "荣誉职位，作为家主配偶的象征，无实权，但地位尊贵。"
    },
    "侍官长": {
        dept: "虞宫内庭",
        count: "一位",
        info: "内庭实际掌权者，家主意志执行人。统管包括训御司在内的一切内庭事务、安保及人员责训。"
    },
    "侍官": {
        dept: "虞宫内庭",
        count: "按事务定员",
        info: "内庭各部门主管，负责财务、物资及内侍人员的考核调配。"
    },
    "从者": {
        dept: "虞宫内庭",
        count: "按事务定员",
        info: "侍官的次手，负责具体执行各部门日常政务与记录工作。"
    },
    "内侍": {
        dept: "虞宫内庭",
        count: "定员",
        info: "仅服务于家主、夫人、亲贵及家主侍奴的贴身仆从。"
    },
    "常侍": {
        dept: "虞宫内庭",
        count: "内庭最多",
        info: "负责管理公奴及以下人员的日常劳作、分配和基础纪律。"
    },
    "杂使": {
        dept: "虞宫内庭",
        count: "不计数",
        info: "负责内庭的清洁、搬运等所有粗重、琐碎的杂活。"
    },

    // --- 各家族职衔 ---
    "管家": {
        dept: "权贵家族",
        count: "每族定员",
        info: "负责权贵家族内府及行政管理的日常负责人。"
    },
    "执事": {
        dept: "贵族家族",
        count: "每族定员",
        info: "辅助贵族管理家族内部事务的具体执行者。"
    }
};

/**
 * 弹出显示职官详情
 */
function showRankDetail(name) {
    const data = rankDatabase[name];
    const modal = document.getElementById('rank-modal');
    if (!data || !modal) return;

    // 填充数据内容
    document.getElementById('rank-modal-title').innerText = name;
    document.getElementById('rank-modal-dept').innerText = data.dept;
    document.getElementById('rank-modal-count').innerText = data.count;
    document.getElementById('rank-modal-content').innerText = data.info;

    // --- 核心修复：强制居中显示 ---
    modal.classList.remove('hidden');
    // 使用 style 直接赋值确保最高优先级，强制 Flex 居中
    modal.style.display = 'flex'; 
    modal.style.zIndex = '10000'; // 确保在最上层
    
    // 如果页面滚动过长，确保弹窗出现在视野中心
    modal.style.top = '0';
    modal.style.left = '0';
    
    document.body.style.overflow = 'hidden'; 
}

function closeRankModal() {
    const modal = document.getElementById('rank-modal');
    if (modal) {
        modal.style.display = 'none';
        modal.classList.add('hidden');
        document.body.style.overflow = ''; 
    }
}